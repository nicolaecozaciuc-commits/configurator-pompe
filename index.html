<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configurator Pompe de C캒ldur캒</title>
    <style>
        /* CSS pentru Design 탳i Func탵ionalitate */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f7f6;
            color: #333;
            line-height: 1.6;
        }
        .configurator-container {
            max-width: 800px;
            margin: 0 auto;
            background-color: #fff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
        }
        h2 { text-align: center; color: #333; margin-bottom: 30px; }
        h3 { color: #007bff; margin-top: 0; }
        
        .progress-bar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            position: relative;
            padding: 0 10px;
        }
        .progress-bar::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 10px;
            right: 10px;
            height: 4px;
            background-color: #e0e0e0;
            transform: translateY(-50%);
            z-index: 0;
        }
        .step-dot {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: #ccc;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            z-index: 1;
            transition: background-color 0.3s;
            cursor: default;
            border: 2px solid #fff;
            font-size: 14px;
        }
        .step-dot.active {
            background-color: #007bff;
            transform: scale(1.1);
        }
        .step-dot.done {
            background-color: #28a745;
            cursor: pointer;
        }
        
        .step-content {
            animation: fadeIn 0.4s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card-option {
            border: 1px solid #ccc;
            padding: 15px;
            margin-bottom: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            background-color: #f9f9f9;
        }
        .card-option:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }
        .card-option.selected {
            border-color: #007bff;
            background-color: #e7f4ff;
            box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.2);
        }
        .card-option h4 {
            margin: 0 0 5px 0;
            color: #007bff;
        }
        .card-option p {
            margin: 0;
            font-size: 0.95em;
            color: #555;
        }

        .button-group {
            margin-top: 30px;
            display: flex;
            justify-content: space-between;
            gap: 10px;
            align-items: flex-start;
        }
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 16px;
            transition: background-color 0.2s;
        }
        .btn:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        .btn-primary {
            background-color: #007bff;
            color: white;
        }
        .btn-primary:hover:not(:disabled) {
            background-color: #0056b3;
            filter: brightness(90%);
        }
        .btn-secondary {
            background-color: #6c757d;
            color: white;
            margin-right: auto;
        }
        .btn-secondary:hover:not(:disabled) {
            background-color: #5a6268;
        }

        .alert-info {
            padding: 12px;
            margin-top: 15px;
            background-color: #e9ecef;
            border-left: 4px solid #17a2b8;
            border-radius: 4px;
            font-size: 0.9em;
        }

        .result-box {
            background-color: #f8fbff;
            border: 1px solid #cce5ff;
            padding: 25px;
            border-radius: 10px;
            margin-top: 20px;
        }
        .power-display {
            font-size: 2em;
            color: #007bff;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .result-detail {
            margin-top: 20px;
            padding: 15px;
            background-color: #fff;
            border-radius: 8px;
            border-left: 4px solid #007bff;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .result-detail h4 { margin-top: 0; margin-bottom: 10px; }
        .result-detail p { margin: 5px 0; font-size: 0.95em; }

        .climatic-zone-map {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .zone-card {
            padding: 15px;
            border-radius: 8px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.2s;
        }
        .zone-card:hover { transform: translateY(-3px); }
        .zone-card.selected { border-color: #333; transform: scale(1.02); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        
        .zone-I { background-color: #e8f5e9; color: #1b5e20; }
        .zone-II { background-color: #fffde7; color: #f57f17; }
        .zone-III { background-color: #ffebee; color: #b71c1c; }
        .zone-IV { background-color: #e3f2fd; color: #0d47a1; }
        .zone-V { background-color: #f3e5f5; color: #4a148c; }

        .dimension-group {
            background: #fff;
            border: 1px solid #ddd;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        .dimension-group h4 { margin-top: 0; color: #555; }
        .floor-heating-group { border-left: 5px solid #28a745; background-color: #f2fff2; }
        .radiator-heating-group { border-left: 5px solid #ffc107; background-color: #fffbf2; }

        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 600; }
        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 16px;
            box-sizing: border-box;
        }
        .form-control:focus { outline: none; border-color: #007bff; box-shadow: 0 0 0 2px rgba(0,123,255,0.25); }

        .city-selector {
            margin-bottom: 25px;
            padding: 15px;
            background: #e7f1ff;
            border-radius: 8px;
            border: 1px solid #b8daff;
        }
        
        .city-selector select {
            width: 100%;
            padding: 12px;
            border-radius: 6px;
            border: 1px solid #007bff;
            font-size: 16px;
            font-weight: bold;
            color: #333;
            cursor: pointer;
        }

        @media (max-width: 600px) {
            .configurator-container { padding: 15px; }
            .climatic-zone-map { grid-template-columns: 1fr; }
            .button-group { flex-direction: column-reverse; }
            .btn { width: 100%; margin: 5px 0; }
        }
    </style>
</head>
<body>

<div class="configurator-container" id="heat_pump_configurator">
    <h2>Configurator Pompe de C캒ldur캒</h2>
    
    <div class="progress-bar" id="progress_bar"></div>

    <div id="step_container" class="step-content"></div>
</div>

<script>
    const stepContainer = document.getElementById('step_container');
    const progressBar = document.getElementById('progress_bar');

    let currentStep = 1;
    const totalSteps = 9;

    let config = {
        buildingType: null,
        city: "",
        climaticZone: null,
        electricConnection: null,
        systemType: null,
        heatingSystem: null,
        floorArea: 0,
        radiatorArea: 0,
        radiatorHeight: 2.7,
        insulation: null,
        windowArea: null,
        windowType: null,
        domesticHotWater: false,
        cooling: false,
        calculatedPower: 0
    };

    const CITY_ZONES = {
        'Constan탵a': 'Zona I', 'Mangalia': 'Zona I', 'Tulcea': 'Zona I',
        'Timi탳oara': 'Zona II', 'Arad': 'Zona II', 'Oradea': 'Zona II', 
        'Craiova': 'Zona II', 'Drobeta-Turnu Severin': 'Zona II', 'Re탳i탵a': 'Zona II', 
        'T칙rgu Jiu': 'Zona II', 'Slatina': 'Zona II', 'Alexandria': 'Zona II', 
        'Giurgiu': 'Zona II', 'C캒l캒ra탳i': 'Zona II', 'Slobozia': 'Zona II', 
        'Br캒ila': 'Zona II', 'Gala탵i': 'Zona II',
        'Bucure탳ti': 'Zona III', 'Ploie탳ti': 'Zona III', 'Pite탳ti': 'Zona III', 
        'T칙rgovi탳te': 'Zona III', 'Buz캒u': 'Zona III', 'Foc탳ani': 'Zona III', 
        'Bac캒u': 'Zona III', 'Ia탳i': 'Zona III', 'Vaslui': 'Zona III', 
        'Deva': 'Zona III', 'Alba Iulia': 'Zona III', 'Suceava': 'Zona III',
        'Cluj-Napoca': 'Zona IV', 'T칙rgu Mure탳': 'Zona IV', 'Sibiu': 'Zona IV', 
        'Bra탳ov': 'Zona IV', 'Sf칙ntu Gheorghe': 'Zona IV', 'Bistri탵a': 'Zona IV', 
        'Zal캒u': 'Zona IV', 'Satu Mare': 'Zona IV', 'Baia Mare': 'Zona IV', 
        'Piatra Neam탵': 'Zona IV', 'Boto탳ani': 'Zona IV', 'R캒d캒u탵i': 'Zona IV',
        'Miercurea Ciuc': 'Zona V', 'Vatra Dornei': 'Zona V', 'Topli탵a': 'Zona V'
    };

    const THERMAL_NEED_M2 = {
        'Zona I': { 'Slab캒': 80, 'Medie': 60, 'Bun캒': 45, 'Excelent캒': 30 },
        'Zona II': { 'Slab캒': 90, 'Medie': 70, 'Bun캒': 50, 'Excelent캒': 35 },
        'Zona III': { 'Slab캒': 100, 'Medie': 80, 'Bun캒': 60, 'Excelent캒': 40 },
        'Zona IV': { 'Slab캒': 110, 'Medie': 90, 'Bun캒': 70, 'Excelent캒': 45 },
        'Zona V': { 'Slab캒': 120, 'Medie': 100, 'Bun캒': 80, 'Excelent캒': 50 }
    };

    const THERMAL_NEED_M3 = {
        'Zona I': { 'Slab캒': 35, 'Medie': 25, 'Bun캒': 20, 'Excelent캒': 15 },
        'Zona II': { 'Slab캒': 40, 'Medie': 30, 'Bun캒': 22, 'Excelent캒': 17 },
        'Zona III': { 'Slab캒': 45, 'Medie': 35, 'Bun캒': 25, 'Excelent캒': 18 },
        'Zona IV': { 'Slab캒': 50, 'Medie': 40, 'Bun캒': 28, 'Excelent캒': 20 },
        'Zona V': { 'Slab캒': 55, 'Medie': 45, 'Bun캒': 32, 'Excelent캒': 22 }
    };

    const WINDOW_FACTOR = {
        'Mic캒-Triplu': 1.05, 'Medie-Triplu': 1.10, 'Mare-Triplu': 1.15,
        'Mic캒-Dublu modern': 1.08, 'Medie-Dublu modern': 1.15, 'Mare-Dublu modern': 1.22,
        'Mic캒-Dublu vechi': 1.15, 'Medie-Dublu vechi': 1.28, 'Mare-Dublu vechi': 1.38,
        'Mic캒-Simplu': 1.25, 'Medie-Simplu': 1.40, 'Mare-Simplu': 1.50
    };

    function renderProgressBar() {
        progressBar.innerHTML = '';
        for (let i = 1; i <= 8; i++) {
            const dot = document.createElement('div');
            dot.className = 'step-dot';
            if (i < currentStep) {
                dot.classList.add('done');
                dot.onclick = () => setStep(i);
            } else if (i === currentStep) {
                dot.classList.add('active');
            }
            dot.textContent = i;
            progressBar.appendChild(dot);
        }
    }

    function createCard(key, value, label, details, zoneClass = '') {
        const isSelected = config[key] === value;
        const detailsHtml = details ? `<p>${details}</p>` : '';
        return `
            <div class="card-option ${isSelected ? 'selected' : ''} ${zoneClass}" onclick="setConfig('${key}', '${value}')">
                <h4>${label}</h4>
                ${detailsHtml}
            </div>
        `;
    }

    function createInput(key, label, placeholder, isFloat = false, min = 0) {
        const val = (config[key] !== undefined && config[key] !== null) ? config[key] : '';
        return `
            <div class="form-group">
                <label>${label}</label>
                <input type="number" class="form-control" value="${val}" placeholder="${placeholder}" min="${min}" step="${isFloat ? '0.1' : '1'}" oninput="setConfigInput('${key}', this.value, ${isFloat})">
            </div>
        `;
    }

    window.setConfig = function(key, value) {
        config[key] = value;
        if(key === 'climaticZone') {
            const currentCityZone = CITY_ZONES[config.city];
            if(currentCityZone !== value) {
                config.city = ""; 
                const select = document.getElementById('citySelect');
                if(select) select.value = "";
            }
        }
        renderStep();
    }

    window.setCity = function(cityName) {
        config.city = cityName;
        if (cityName && CITY_ZONES[cityName]) {
            config.climaticZone = CITY_ZONES[cityName];
        }
        renderStep();
    }

    window.toggleConfig = function(key) {
        config[key] = !config[key];
        renderStep();
    }

    window.setConfigInput = function(key, value, isFloat) {
        if (value === '') {
             config[key] = 0;
        } else {
             config[key] = isFloat ? parseFloat(value) : parseInt(value);
        }
        updateUIState(); 
    }

    function updateUIState() {
        const isValid = validateStep(currentStep);
        const btnNext = document.getElementById('btn-next');
        if (btnNext) {
            btnNext.disabled = !isValid;
        }

        if (currentStep === 6) {
            const volDisplay = document.getElementById('volume-display');
            if (volDisplay) {
                const vol = ((config.radiatorArea || 0) * (config.radiatorHeight || 0)).toFixed(1);
                volDisplay.textContent = vol + ' m췁';
            }
        }
    }

    window.setStep = function(step) {
        currentStep = step;
        if (currentStep === 9) calculateResults();
        renderProgressBar();
        renderStep();
        window.scrollTo(0,0);
    }

    function validateStep(step) {
        if (step === 1) return !!config.buildingType;
        if (step === 2) return !!config.climaticZone;
        if (step === 3) return !!config.electricConnection;
        if (step === 4) return !!config.systemType;
        if (step === 5) return !!config.heatingSystem;
        if (step === 6) {
            const h = config.heatingSystem;
            if (h === 'Pardoseal캒') return config.floorArea > 0;
            if (h === 'Radiatoare' || h === 'Ventiloconvectoare') return config.radiatorArea > 0 && config.radiatorHeight > 0;
            if (h === 'Mix') return (config.floorArea > 0 || config.radiatorArea > 0) && config.radiatorHeight > 0;
            return false;
        }
        if (step === 7) return !!config.windowArea && !!config.windowType;
        if (step === 8) return !!config.insulation;
        return true;
    }

    function calculateResults() {
        const zone = config.climaticZone;
        const ins = config.insulation;
        const hSystem = config.heatingSystem;
        
        let power = 0;
        let details = "";

        if (!THERMAL_NEED_M2[zone] || !THERMAL_NEED_M2[zone][ins]) {
            config.calculatedPower = "Eroare";
            return;
        }

        const wM2 = THERMAL_NEED_M2[zone][ins];
        const wM3 = THERMAL_NEED_M3[zone][ins];
        
        if (hSystem === 'Pardoseal캒') {
            const p = (config.floorArea * wM2 * 0.9) / 1000;
            power += p;
        } else if (hSystem === 'Radiatoare' || hSystem === 'Ventiloconvectoare') {
            const vol = config.radiatorArea * config.radiatorHeight;
            const factor = hSystem === 'Radiatoare' ? 1.0 : 0.95;
            const p = (vol * wM3 * factor) / 1000;
            power += p;
        } else if (hSystem === 'Mix') {
            const pFloor = (config.floorArea * wM2 * 0.9) / 1000;
            const vol = config.radiatorArea * config.radiatorHeight;
            const pRad = (vol * wM3 * 1.0) / 1000;
            power += (pFloor || 0) + (pRad || 0);
        }

        const winKey = config.windowArea + '-' + config.windowType;
        const winFactor = WINDOW_FACTOR[winKey] || 1.1;
        
        power = power * winFactor;
        power = power * 1.1;

        config.calculatedPower = isNaN(power) ? "0.00" : power.toFixed(2);
    }

    function renderStep() {
        let html = '';
        const isValid = validateStep(currentStep);

        if (currentStep === 1) {
            html += `<h3>Pasul 1: Tipul de Cl캒dire</h3>`;
            html += createCard('buildingType', 'Apartament', 'Apartament', '');
            html += createCard('buildingType', 'Cas캒', 'Cas캒', '');
            html += createCard('buildingType', 'Comercial', 'Spa탵iu Comercial', '');
        } 
        else if (currentStep === 2) {
            html += `<h3>Pasul 2: Zona Climatic캒 (NP-048-2000)</h3>`;
            
            html += `
            <div class="city-selector">
                <label style="display:block; margin-bottom:10px;">Selecteaz캒 Ora탳ului T캒u (Determinare Automat캒):</label>
                <select id="citySelect" onchange="setCity(this.value)">
                    <option value="">-- Alege din list캒 (34+ Ora탳e) --</option>
                    ${Object.keys(CITY_ZONES).sort().map(city => 
                        `<option value="${city}" ${config.city === city ? 'selected' : ''}>${city} (${CITY_ZONES[city]})</option>`
                    ).join('')}
                </select>
            </div>
            `;

            html += `<div class="climatic-zone-map">`;
            html += createCard('climaticZone', 'Zona I', 'Zona I (-10춿C)', 'Constan탵a, Tulcea. Climat Bl칙nd.', 'zone-I');
            html += createCard('climaticZone', 'Zona II', 'Zona II (-15춿C)', 'Craiova, Timi탳oara, Oradea. Moderat.', 'zone-II');
            html += createCard('climaticZone', 'Zona III', 'Zona III (-18춿C)', 'Bucure탳ti, Ia탳i, Suceava. Temperat.', 'zone-III');
            html += createCard('climaticZone', 'Zona IV', 'Zona IV (-21춿C)', 'Cluj, Bra탳ov, R캒d캒u탵i. Rece.', 'zone-IV');
            html += createCard('climaticZone', 'Zona V', 'Zona V (-24춿C)', 'Miercurea Ciuc, Vatra Dornei. Foarte Rece.', 'zone-V');
            html += `</div>`;
        }
        else if (currentStep === 3) {
            html += `<h3>Pasul 3: Bran탳ament Electric</h3>`;
            html += createCard('electricConnection', 'Monofazat', 'Monofazat (230V)', 'Bran탳ament standard.');
            html += createCard('electricConnection', 'Trifazat', 'Trifazat (380V)', 'Putere mare disponibila.');
        }
        else if (currentStep === 4) {
            html += `<h3>Pasul 4: Tip Sistem</h3>`;
            html += createCard('systemType', 'Split', 'Split', 'Exterior + Interior (cu freon).');
            html += createCard('systemType', 'Monobloc', 'Monobloc', 'Doar exterior (ap캒). Simplu de instalat.');
            html += createCard('systemType', 'Hydrosplit', 'Hydrosplit', 'Exterior + Interior (ap캒). Performan탵캒.');
        }
        else if (currentStep === 5) {
            html += `<h3>Pasul 5: Sistem de 칉nc캒lzire</h3>`;
            html += createCard('heatingSystem', 'Pardoseal캒', '칉nc캒lzire 칥n Pardoseal캒', 'Calcul W/m. Eficien탵캒 maxim캒.');
            html += createCard('heatingSystem', 'Radiatoare', 'Radiatoare Clasice', 'Calcul W/m췁 (Volum). Temp ridicat캒.');
            html += createCard('heatingSystem', 'Mix', 'Mix Pardoseal캒 + Radiatoare', 'Calcul combinat m 탳i m췁.');
            html += createCard('heatingSystem', 'Ventiloconvectoare', 'Ventiloconvectoare', 'Calcul W/m췁. R캒cire eficient캒.');
        }
        else if (currentStep === 6) {
            html += `<h3>Pasul 6: Dimensiuni</h3>`;
            
            if (!config.heatingSystem) {
                 html += '<p class="alert-info">V캒 rug캒m selecta탵i un sistem de 칥nc캒lzire la pasul anterior.</p>';
            }
            else if (config.heatingSystem === 'Pardoseal캒') {
                html += `<div class="dimension-group floor-heating-group">
                    <h4>Zon캒 Pardoseal캒</h4>
                    ${createInput('floorArea', 'Suprafa탵캒 칉nc캒lzit캒 (m)', 'ex: 120')}
                    <p class="alert-info">Se calculeaz캒 folosind necesarul specific 칥n W/m.</p>
                </div>`;
            } else if (config.heatingSystem === 'Radiatoare' || config.heatingSystem === 'Ventiloconvectoare') {
                html += `<div class="dimension-group radiator-heating-group">
                    <h4>Zon캒 Radiatoare</h4>
                    ${createInput('radiatorArea', 'Suprafa탵캒 칉nc캒lzit캒 (m)', 'ex: 120')}
                    ${createInput('radiatorHeight', '칉n캒l탵ime medie (m)', 'ex: 2.7', true)}
                    <p class="alert-info">Volum calculat: <strong id="volume-display">${((config.radiatorArea || 0) * (config.radiatorHeight || 0)).toFixed(1)} m췁</strong>. Se folose탳te normativul C107 (W/m췁).</p>
                </div>`;
            } else if (config.heatingSystem === 'Mix') {
                html += `<div class="dimension-group floor-heating-group">
                    <h4>游릭 Zon캒 Pardoseal캒</h4>
                    ${createInput('floorArea', 'Suprafa탵캒 Pardoseal캒 (m)', 'ex: 60')}
                </div>`;
                html += `<div class="dimension-group radiator-heating-group">
                    <h4>游 Zon캒 Radiatoare</h4>
                    ${createInput('radiatorArea', 'Suprafa탵캒 Radiatoare (m)', 'ex: 60')}
                    ${createInput('radiatorHeight', '칉n캒l탵ime medie (m)', 'ex: 2.7', true)}
                    <p>Volum radiatoare: <strong id="volume-display">${((config.radiatorArea || 0) * (config.radiatorHeight || 0)).toFixed(1)} m췁</strong></p>
                </div>`;
            }
        }
        else if (currentStep === 7) {
            html += `<h3>Pasul 7: Suprafa탵캒 Vitrat캒</h3>`;
            html += `<div class="form-group"><label>Propor탵ie Ferestre</label>`;
            html += createCard('windowArea', 'Mic캒', 'Mic캒 (<10%)', 'Ferestre normale.');
            html += createCard('windowArea', 'Medie', 'Medie (10-20%)', 'Cas캒 luminoas캒.');
            html += createCard('windowArea', 'Mare', 'Mare (>20%)', 'Panoramic / Pere탵i sticl캒.');
            html += `</div>`;
            
            if (config.windowArea) {
                html += `<div class="form-group"><label>Tip Geam</label>`;
                html += createCard('windowType', 'Triplu', 'Triplu Strat', 'Eficien탵캒 maxim캒.');
                html += createCard('windowType', 'Dublu modern', 'Dublu (Modern)', 'Termopan standard.');
                html += createCard('windowType', 'Dublu vechi', 'Dublu (Vechi)', 'Termopan genera탵ie veche.');
                html += createCard('windowType', 'Simplu', 'Simplu', 'Pierderi mari.');
                html += `</div>`;
            }
        }
        else if (currentStep === 8) {
            html += `<h3>Pasul 8: Izola탵ie & Op탵iuni</h3>`;
            html += `<div class="form-group"><label>Nivel Izola탵ie Cl캒dire</label>`;
            html += createCard('insulation', 'Slab캒', 'Slab캒', 'Zid캒rie simpl캒, f캒r캒 polistiren.');
            html += createCard('insulation', 'Medie', 'Medie', 'Polistiren 5cm.');
            html += createCard('insulation', 'Bun캒', 'Bun캒', 'Polistiren 10cm, vat캒.');
            html += createCard('insulation', 'Excelent캒', 'Excelent캒', 'NZEB, 15cm+, tripan.');
            html += `</div>`;
            
            html += `<hr>`;
            html += `<div class="card-option ${config.domesticHotWater ? 'selected' : ''}" onclick="toggleConfig('domesticHotWater')">
                <h4>Ap캒 Cald캒 Menajer캒 (ACM)</h4>
            </div>`;
             html += `<div class="card-option ${config.cooling ? 'selected' : ''}" onclick="toggleConfig('cooling')">
                <h4>Func탵ie R캒cire</h4>
            </div>`;
        }
        else if (currentStep === 9) {
            const volRad = ((config.radiatorArea || 0) * (config.radiatorHeight || 0)).toFixed(1);
            
            html += `<h3>Rezultate Configurare</h3>`;
            
            html += `<div class="result-box">`;
            html += `<div class="power-display">${config.calculatedPower} kW</div>`;
            html += `<p style="text-align:center">Putere termic캒 necesar캒 estimat캒 (Inclusiv rezerv캒 10%)</p>`;
            
            html += `<div class="result-detail">`;
            html += `<h4>Sumar Date</h4>`;
            html += `<p><strong>Loca탵ie:</strong> ${config.city ? config.city + ' (' + config.climaticZone + ')' : config.climaticZone}</p>`;
            html += `<p><strong>Sistem:</strong> ${config.heatingSystem}</p>`;
            if (config.floorArea > 0) html += `<p><strong>Pardoseal캒:</strong> ${config.floorArea} m</p>`;
            if (config.radiatorArea > 0) html += `<p><strong>Radiatoare:</strong> ${config.radiatorArea} m (${volRad} m췁)</p>`;
            html += `<p><strong>Izola탵ie:</strong> ${config.insulation}</p>`;
            html += `<p><strong>Bran탳ament:</strong> ${config.electricConnection}</p>`;
            html += `</div>`;

            html += `<div class="result-detail" style="border-left-color: #28a745;">`;
            html += `<h4>Detalii Calcul (Conform C107)</h4>`;
            html += `<p>Necesar specific pardoseal캒: <strong>${THERMAL_NEED_M2[config.climaticZone][config.insulation]} W/m</strong></p>`;
            html += `<p>Necesar specific volum: <strong>${THERMAL_NEED_M3[config.climaticZone][config.insulation]} W/m췁</strong></p>`;
            
            const winFactor = WINDOW_FACTOR[config.windowArea + '-' + config.windowType];
            html += `<p>Factor corec탵ie ferestre: <strong>x${winFactor}</strong> (${config.windowArea}, ${config.windowType})</p>`;
            html += `<p>Factor siguran탵캒: <strong>x1.1</strong></p>`;
            html += `</div>`;
            
            html += `</div>`;
        }

        html += `<div class="button-group" style="${currentStep === 9 ? 'flex-wrap: wrap; gap: 10px;' : ''}">`;
        if (currentStep > 1) {
            html += `<button class="btn btn-secondary" onclick="setStep(${currentStep - 1})">칉napoi</button>`;
        }
        if (currentStep < 9) {
            let btnText = currentStep === 8 ? "Calculeaz캒 Rezultat" : "Continu캒";
            html += `<button id="btn-next" class="btn btn-primary" onclick="setStep(${currentStep + 1})" ${!isValid ? 'disabled' : ''}>${btnText}</button>`;
        } else {
             html += `<div style="display:flex; flex-direction:column; gap:10px; flex:1; margin-left: 10px;">`;
             html += `<button class="btn btn-primary" onclick="redirectToShop()" style="background-color: #e60000; border-color: #cc0000; width:100%;">游댌 Vezi ofert캒 CasaInstalatorului.ro</button>`;
             html += `<button class="btn btn-primary" onclick="redirectToTermohabitat()" style="background-color: #2c3e50; border-color: #1a252f; width:100%;">游댌 Vezi ofert캒 Termohabitat.ro</button>`;
             html += `</div>`;
        }
        html += `</div>`;

        stepContainer.innerHTML = html;
    }

    window.redirectToShop = function() {
        const power = parseFloat(config.calculatedPower);
        let capacity = 0;
        
        if (power <= 4) capacity = 4;
        else if (power <= 6) capacity = 6;
        else if (power <= 8) capacity = 8;
        else if (power <= 10) capacity = 10;
        else if (power <= 12) capacity = 12;
        else if (power <= 14) capacity = 14;
        else if (power <= 16) capacity = 16;
        else capacity = Math.ceil(power); 

        let systemType = config.systemType ? config.systemType.toLowerCase() : "";
        if (systemType === 'hydrosplit') systemType = 'split'; 

        const searchTerm = `pompa caldura ${systemType} "${capacity} kW"`;
        const url = `https://www.casainstalatorului.ro/?s=${encodeURIComponent(searchTerm)}&post_type=product`;
        window.open(url, '_blank');
    }

    window.redirectToTermohabitat = function() {
        const power = parseFloat(config.calculatedPower);
        let capacity = 0;
        
        if (power <= 4) capacity = 4;
        else if (power <= 6) capacity = 6;
        else if (power <= 8) capacity = 8;
        else if (power <= 10) capacity = 10;
        else if (power <= 12) capacity = 12;
        else if (power <= 14) capacity = 14;
        else if (power <= 16) capacity = 16;
        else capacity = Math.ceil(power); 

        let systemType = config.systemType ? config.systemType.toLowerCase() : "";
        if (systemType === 'hydrosplit') systemType = 'split'; 

        const searchTerm = `pompa caldura ${systemType} "${capacity} kW"`;
        const url = `https://termohabitat.ro/?s=${encodeURIComponent(searchTerm)}&post_type=product`;
        window.open(url, '_blank');
    }

    renderProgressBar();
    renderStep();

</script>

</body>
</html>
